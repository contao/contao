{% trans_default_domain 'contao_template_studio' %}
{% extends '@Contao/be_main.html.twig' %}

{# Remove global ace assets #}
{% block ace_assets %}{% endblock %}

{% block main %}
    {% set template_studio_attrs = attrs()
        .set('id', 'main')
        .set('aria-labelledby', 'main_headline')
        .set('data-controller', 'contao--template-studio')
        .set('data-action', 'contao--color-scheme:change@window->contao--template-studio#colorChange')
        .set('data-contao--template-studio-follow-url-value', path('_contao_template_studio_follow.stream'))
        .set('data-contao--template-studio-block-info-url-value', path('_contao_template_studio_block_info.stream'))
        .set('data-twig-environment', environment_information|json_encode)
        .mergeWith(template_studio_attrs|default)
    %}
    <main{{ template_studio_attrs }}>
        {# Headline #}
        <h1 id="main_headline">
            {{ headline }}
            {% set fullscreen_button_attributes = attrs()
                .addClass('fullscreen')
                .set('data-action', 'contao--template-studio#enterFullscreen')
                .set('data-contao--tooltips-target', 'tooltip')
                .set('title', 'MSC.enter_fullscreen'|trans(domain: 'contao_default'))
            %}
            <button{{ fullscreen_button_attributes }}>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 7V5a2 2 0 0 1 2-2h2"/>
                    <path d="M17 3h2a2 2 0 0 1 2 2v2"/>
                    <path d="M21 17v2a2 2 0 0 1-2 2h-2"/>
                    <path d="M7 21H5a2 2 0 0 1-2-2v-2"/>
                    <rect width="10" height="8" x="7" y="8" rx="1"/>
                </svg>
            </button>
            {{ include('@Contao/backend/component/_favorites.html.twig') }}
        </h1>

        <section id="template-studio" class="content chrome" data-contao--template-studio-target="content">
            <div id="template-studio--nav">
                {# Theme selector #}
                {% if themes|length %}
                    <form id="template-studio--theme-selector" method="post" action="{{ path('_contao_template_studio_select_theme.stream') }}" data-turbo-stream data-contao--template-studio-target="themeSelector">
                        <label data-controller="contao--choices">
                            <select name="theme" onchange="this.form.requestSubmit()" class="tl_select">
                                <option{{ attrs().set('value', '').set('selected', current_theme is null) }}>{{ 'no_theme_context'|trans }}</option>
                                {% for slug, name in themes %}
                                    <option{{ attrs().set('value', slug).set('selected', current_theme == slug) }}>{{ name }} [{{ slug }}]</option>
                                {% endfor %}
                            </select>
                            <span>{{ 'theme-selector'|trans }}</span>
                        </label>
                    </form>
                {% endif %}

                {# Identifier tree #}
                <div id="template-studio--tree">
                    {{ include('@Contao/backend/template_studio/tree/_tree.html.twig') }}
                </div>
            </div>

            {# Main editor section with multiple tabs #}
            {% embed '@Contao/backend/component/tabs/_container.html.twig' with {
                tabs_container_attributes: attrs().set('data-contao--template-studio-target', 'tabs'),
                id: 'template-studio--tabs',
                panels_container_id: 'template-studio--tab-panels',
            } %}
                {% trans_default_domain 'contao_template_studio' %}

                {% block initial_content %}
                    <div class="explainer">
                        <h3>{{ 'getting-started.0'|trans }}</h3>
                        <p>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                 fill="none"
                                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m12 19-7-7 7-7"/>
                                <path d="M19 12H5"/>
                            </svg>
                            {{ 'getting-started.1'|trans }}
                        </p>
                    </div>
                {% endblock %}
            {% endembed %}

            {# Info panel #}
            <div id="template-studio--info" data-panel></div>
        </section>
    </main>
{% endblock %}
