{% trans_default_domain "contao_default" %}

{% set table_attributes = attrs()
    .set('id', 'ctrl_' ~ id)
    .set('data-controller', 'contao--row-wizard')
    .addClass('tl_key_value_wizard')
%}
<table{{ table_attributes }}>
    <thead>
        <tr>
            <th></th>
            <th>{{ keyLabel|default('MSC.ow_key'|trans) }}</th>
            <th>{{ valueLabel|default('MSC.ow_value'|trans) }}</th>
            <th></th>
        </tr>
    </thead>
    <tbody class="sortable" data-controller="contao--sortable" data-contao--sortable-handle-value=".drag-handle" data-action="contao--sortable:update->contao--row-wizard#updateSorting" data-contao--row-wizard-target="body">
        {% for row in rows %}
            <tr data-contao--row-wizard-target="row">
                <td>
                    {# Drag row #}
                    {% set drag_handle_attributes = attrs()
                        .set('type', 'button')
                        .set('data-action', 'keydown->contao--sortable#move')
                        .set('aria-hidden', 'true')
                        .addClass('drag-handle')
                    %}
                    <button{{ drag_handle_attributes}}>{{ backend_icon('drag.svg', 'MSC.move'|trans) }}</button>
                </td>
                <td>
                    {% set key_attributes = attrs()
                        .set('type', 'text')
                        .set('name', "#{id}[#{loop.index0}][key]")
                        .set('id', '#{id}_key_#{loop.index0}')
                        .set('value', row.key|default)
                        .addClass('tl_text')
                    %}
                    <input{{ key_attributes }}>
                </td>
                <td>
                    {% set value_attributes = attrs()
                        .set('type', 'text')
                        .set('name', "#{id}[#{loop.index0}][value]")
                        .set('id', '#{id}_value_#{loop.index0}')
                        .set('value', row.value|default)
                        .addClass('tl_text')
                    %}
                    <input{{ value_attributes }}>
                </td>

                {# Controls #}
                <td class="tl_right">
                    {# Copy row #}
                    {% set copy_button_attributes = attrs()
                        .set('type', 'button')
                        .set('data-action', 'contao--row-wizard#copy contao--scroll-offset#store')
                    %}
                    <button{{ copy_button_attributes }}>{{ backend_icon('copy.svg', 'MSC.ow_copy'|trans) }}</button>

                    {# Delete row #}
                    {% set delete_button_attributes = attrs()
                        .set('type', 'button')
                        .set('data-action', 'contao--row-wizard#delete contao--scroll-offset#store')
                    %}
                    <button{{ delete_button_attributes }}>{{ backend_icon('delete.svg', 'MSC.ow_delete'|trans) }}</button>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
