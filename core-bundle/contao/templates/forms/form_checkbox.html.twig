{% extends "@Contao/form_row.html.twig" %}

{% block field %}
  <fieldset id="ctrl_{{ this.id }}" class="checkbox_container{% if this.class|default %} {{ this.class|default }}{% endif %}"{% if this.help %} aria-describedby="help_ctrl_{{ this.id }}"{% endif %}>

    {% if this.label %}
      <legend>
        {% if this.mandatory %}
          <span class="invisible">{{ this.mandatoryField }} </span>{{ this.label }}<span class="mandatory">*</span>
        {% else %}
          {{ this.label }}
        {% endif %}
      </legend>
    {% endif %}

    {% if hasErrors.invoke() %}
      <p class="error">{{ getErrorAsString.invoke() }}</p>
    {% endif %}

    <input type="hidden" name="{{ this.name }}" value="">

    {% for option in getOptions.invoke() %}
      {% if option.type == 'group_start' %}
        <fieldset>
        <legend>{{ option.label }}</legend>
      {% endif %}

      {% if option.type == 'option' %}
        {% set input_attributes = attrs()
            .set('type', 'checkbox')
            .set('name', option.name)
            .set('id', 'opt_' ~ option.id)
            .addClass('checkbox')
            .set('value', option.value)
            .set('checked', option.checked, option.checked)
            .mergeWith(option.attributes)
        %}
        <span><input{{ input_attributes }}> <label id="lbl_{{ option.id }}" for="opt_{{ option.id }}">{{ option.label }}</label></span>
      {% endif %}

      {% if option.type == 'group_end' %}
        </fieldset>
      {% endif %}
    {% endfor %}

    {% if this.help %}
      <p class="help" id="help_ctrl_{{ this.id }}">{{ this.help }}</p>
    {% endif %}

  </fieldset>
{% endblock %}
